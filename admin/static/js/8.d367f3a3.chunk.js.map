{"version":3,"sources":["pages/Admin/ArticleList/index.js"],"names":["ArticleTable","article","del","auth","columns","title","dataIndex","filters","text","value","onFilter","record","draft","render","key","to","pathname","query","data","type","okText","onConfirm","cancelText","href","dataSource","expandedRowRender","style","margin","introduction","rowKey","id","ArticleList","props","useState","setArticle","setAuth","useEffect","getArticleList","a","params","getContent","location","userId","http","method","url","info","delete","_id","code","message","success"],"mappings":"0NA4CA,IAAMA,EAAe,SAAC,GAA4B,IAA1BC,EAAyB,EAAzBA,QAASC,EAAgB,EAAhBA,IAAKC,EAAW,EAAXA,KAC9BC,EAAU,CACd,CACEC,MAAO,2BACPC,UAAW,SAEb,CACED,MAAO,eACPC,UAAW,UAEb,CACED,MAAO,qBACPC,UAAW,aAEb,CACED,MAAO,eACPC,UAAW,QACXC,QAAS,CAAC,CAAEC,KAAM,eAAMC,MAAO,GAAK,CAAED,KAAM,eAAMC,MAAO,IACzDC,SAAU,SAACD,EAAOE,GAChB,OAAOA,EAAOC,OAASH,GAEzBI,OAAQ,SAACL,EAAMG,GAEb,MADc,CAAC,eAAM,gBACRH,KAGjB,CACEH,MAAO,eACPC,UAAW,YACXQ,IAAK,YACLD,OAAQ,SAACL,EAAMG,GAAP,OACNR,EAAO,8BACL,kBAAC,IAAD,CAAMY,GACJ,CACEC,SAAS,sBACTC,MAAO,CAAEC,KAAMP,KAHnB,gBADK,IAMO,kBAAC,IAAD,CAASQ,KAAK,aAC1B,kBAAC,IAAD,CAAYd,MAAM,6CAChBe,OAAO,eACPC,UAAW,WAAQnB,EAAIS,IACvBW,WAAW,gBACX,uBAAGC,KAAK,KAAR,kBAEO,+EAIjB,OAAQ,oCACN,kBAAC,IAAD,CAAOnB,QAASA,EACdoB,WAAYvB,EACZwB,kBAAmB,SAAAd,GAAM,OAAI,uBAAGe,MAAO,CAAEC,OAAQ,IAAMhB,EAAOiB,eAC9DC,OAAQ,SAACX,GAAD,OAAWA,EAAKY,QAIfC,UA7Ff,YAAiC,IAAVC,EAAS,EAATA,MAAS,EACAC,mBAAS,IADT,mBACvBhC,EADuB,KACdiC,EADc,OAEND,qBAFM,mBAEvB9B,EAFuB,KAEjBgC,EAFiB,KAG9BC,qBAAU,WACRC,MACC,IAEH,IAAMA,EAAc,uCAAG,gCAAAC,EAAA,6DACjBC,EAAS,CACXC,YAAY,GAEVR,EAAMS,SAASxB,QACjBsB,EAAM,OAAaP,EAAMS,SAASxB,MAAMyB,OAASV,EAAMS,SAASxB,MAAMyB,OAAS,IAL5D,SAOAC,YAAK,CACxBC,OAAQ,MACRC,IAAK,sBACLN,WAVmB,gBAOfrB,EAPe,EAOfA,KAKNgB,EAAWhB,EAAKA,KAAK4B,MACrBX,EAAQjB,EAAKf,MAbQ,2CAAH,qDAgBdD,EAAG,uCAAG,WAAOgB,GAAP,SAAAoB,EAAA,sEACQK,IAAKI,OAAL,gCAAqC7B,EAAK8B,MADlD,OAEW,KAFX,OAEF9B,KAAK+B,OACXC,IAAQC,QAAQ,6BAChBd,KAJQ,2CAAH,sDAQT,OAAQ,6BACN,kBAAC,IAAD,CAAYhC,MAAM,6BAClB,kBAACL,EAAD,CAAcC,QAASA,EAASC,IAAKA,EAAKC,KAAMA","file":"static/js/8.d367f3a3.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport { Form, Input, PageHeader, Button, Row, Col, Divider, Table, Popconfirm, message } from 'antd';\r\nimport { Link } from 'react-router-dom'\r\nimport http from '@/utils/http'\r\n\r\n\r\n\r\nfunction ArticleList({ props }) {\r\n  const [article, setArticle] = useState([]);\r\n  const [auth, setAuth] = useState();\r\n  useEffect(() => {\r\n    getArticleList()\r\n  }, [])\r\n\r\n  const getArticleList = async () => {\r\n    let params = {\r\n      getContent: true\r\n    }\r\n    if (props.location.query)\r\n      params['userId'] = props.location.query.userId ? props.location.query.userId : '';\r\n\r\n    let { data } = await http({\r\n      method: 'get',\r\n      url: '/admin/article/list',\r\n      params\r\n    })\r\n    setArticle(data.data.info)\r\n    setAuth(data.auth)\r\n  }\r\n\r\n  const del = async (data) => {\r\n    const res = await http.delete(`/admin/article/delOne/${data._id}`)\r\n    if (res.data.code == 200) {\r\n      message.success('删除成功!')\r\n      getArticleList()\r\n    }\r\n  }\r\n\r\n  return (<div>\r\n    <PageHeader title=\"文章管理\" />\r\n    <ArticleTable article={article} del={del} auth={auth} />\r\n  </div>)\r\n}\r\n\r\nconst ArticleTable = ({ article, del, auth }) => {\r\n  const columns = [\r\n    {\r\n      title: '文章标题',\r\n      dataIndex: 'title'\r\n    },\r\n    {\r\n      title: '作者',\r\n      dataIndex: 'author'\r\n    },\r\n    {\r\n      title: '阅读量',\r\n      dataIndex: 'viewCount'\r\n    },\r\n    {\r\n      title: '状态',\r\n      dataIndex: 'draft',\r\n      filters: [{ text: '文章', value: 0 }, { text: '草稿', value: 1 }],\r\n      onFilter: (value, record) => {\r\n        return record.draft == value\r\n      },\r\n      render: (text, record) => {\r\n        const draft = ['文章', '草稿']\r\n        return draft[text]\r\n      }\r\n    },\r\n    {\r\n      title: '操作',\r\n      dataIndex: 'operation',\r\n      key: 'operation',\r\n      render: (text, record) => (\r\n        auth ? <span>\r\n          <Link to={\r\n            {\r\n              pathname: `/article/addArticle`,\r\n              query: { data: record }\r\n            }\r\n          }>编辑</Link> <Divider type=\"vertical\" />\r\n          <Popconfirm title=\"确定要删除吗？\"\r\n            okText=\"确定\"\r\n            onConfirm={() => { del(record) }}\r\n            cancelText=\"取消\">\r\n            <a href=\"#\">删除</a>\r\n          </Popconfirm>\r\n        </span > : <span>您暂无操作权限</span>\r\n      )\r\n    }\r\n  ]\r\n  return (<>\r\n    <Table columns={columns}\r\n      dataSource={article}\r\n      expandedRowRender={record => <p style={{ margin: 0 }}>{record.introduction}</p>}\r\n      rowKey={(data) => (data.id)} />\r\n  </>)\r\n}\r\n\r\nexport default ArticleList;"],"sourceRoot":""}