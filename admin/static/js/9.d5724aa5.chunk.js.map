{"version":3,"sources":["pages/Admin/Category/CategoryComponent.js","pages/Admin/Category/index.js"],"names":["CategoryComponent","visibility","changeVisibility","editItem","getCategory","useState","categoryName","setCategoryName","categoryDesc","setCategoryDesc","confirmLoading","setConfirmLoading","useEffect","name","desc","closeDiaglog","a","editCategory","http","method","url","data","id","then","code","message","success","error","catch","addCategory","params","setting","title","width","visible","onCancel","onOk","okText","cancelText","destroyOnClose","defaultValue","onChange","e","target","value","addonBefore","size","placeholder","style","marginBottom","FormItem","Form","Item","React","memo","props","showDialog","setCategoryDialog","setEditItem","listData","setListData","loading","setLoad","Mounted","setMounted","auth","setAuth","total","get","length","console","log","add","layout","gutter","md","lg","xl","sm","textAlign","marginTop","marginRight","type","icon","onClick","defaultSetting","defaultCurrent","showSizeChanger","edit","item","del","columns","dataIndex","key","sorter","render","text","record","onConfirm","href","dataSource","bordered","rowKey","pagination","page","pageSize"],"mappings":"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","file":"static/js/9.d5724aa5.chunk.js","sourcesContent":["import React, { useContext, useState, useEffect } from 'react'\r\nimport { Modal, Input, message } from 'antd';\r\nimport http from '@/utils/http'\r\n/* \r\n TODO 传值声明\r\n  visibility:显示隐藏\r\n  changeVisibility：控制显示隐藏的方法\r\n  editItem：编辑时使用的值\r\n  setEditTtem: 修改传入的值，根据值是否为null判断编辑还是新建\r\n*/\r\n\r\n\r\nconst CategoryComponent = ({\r\n  visibility = false,\r\n  changeVisibility,\r\n  editItem = null,\r\n  getCategory }\r\n) => {\r\n  const [categoryName, setCategoryName] = useState('')\r\n  const [categoryDesc, setCategoryDesc] = useState('')\r\n  const [confirmLoading, setConfirmLoading] = useState(false)\r\n  useEffect(() => {\r\n    if (editItem != null) {\r\n      setCategoryName(editItem.name)\r\n      setCategoryDesc(editItem.desc)\r\n    } else {\r\n      setCategoryName('')\r\n      setCategoryDesc('')\r\n    }\r\n  }, [editItem])\r\n  //关闭事件\r\n  const closeDiaglog = async () => {\r\n    changeVisibility(false)\r\n  }\r\n\r\n  //确定事件\r\n  const submitCategory = () => {\r\n    if (!categoryName) {\r\n      message.error('分类名不能为空!'); return;\r\n    }\r\n    if (editItem !== null) {\r\n      editCategory()\r\n    } else {\r\n      addCategory()\r\n    }\r\n  }\r\n  const editCategory = async () => {\r\n    setConfirmLoading(true);\r\n    await http({\r\n      method: 'post',\r\n      url: '/admin/category/edit',\r\n      data: {\r\n        id: editItem.id,\r\n        name: categoryName,\r\n        desc: categoryDesc\r\n      }\r\n    }).then(({ data }) => {\r\n      if (data.code == 0) {\r\n        message.success(data.message);\r\n        closeDiaglog();\r\n        getCategory();\r\n      } else {\r\n        message.error(data.message)\r\n      }\r\n    }).catch(() => message.error('未知错误'))\r\n    setConfirmLoading(false);\r\n  }\r\n  const addCategory = async () => {\r\n    setConfirmLoading(true);\r\n    await http({\r\n      method: 'get',\r\n      url: '/admin/category/add',\r\n      params: {\r\n        name: categoryName,\r\n        desc: categoryDesc\r\n      }\r\n    }).then(({ data }) => {\r\n      if (data.code == 0) {\r\n        message.success(data.message);\r\n        closeDiaglog()\r\n        getCategory();\r\n      } else {\r\n        message.error(data.message)\r\n      }\r\n    }).catch(() => message.error('未知错误'))\r\n    setConfirmLoading(false);\r\n  }\r\n  // Modal基础设置\r\n  const setting = {\r\n    title: editItem == null ? \"添加分类\" : \"编辑分类\",\r\n    width: \"600px\",\r\n    visible: visibility,\r\n    onCancel: closeDiaglog,\r\n    onOk: submitCategory,\r\n    confirmLoading: confirmLoading,\r\n    okText: editItem == null ? \"创建\" : \"提交\",\r\n    cancelText: \"取消\",\r\n    destroyOnClose: true\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      {...setting}\r\n    >\r\n      <Input\r\n        defaultValue={editItem !== null ? categoryName : ''}\r\n        onChange={(e) => { setCategoryName(e.target.value) }}\r\n        addonBefore=\"分类名\"\r\n        size=\"large\"\r\n        placeholder=\"分类名\"\r\n        name=\"name\"\r\n        style={{ marginBottom: 20 }}\r\n      />\r\n      <Input\r\n        defaultValue={editItem !== null ? categoryDesc : ''}\r\n        onChange={(e) => { setCategoryDesc(e.target.value) }}\r\n        addonBefore=\"描述\"\r\n        size=\"large\"\r\n        placeholder=\"描述\"\r\n        name=\"desc\"\r\n      />\r\n    </Modal>\r\n  )\r\n}\r\n\r\nexport default CategoryComponent;\r\n\r\nconst errorTips = (error) => {\r\n  if (error.response) {\r\n    // The request was made and the server responded with a status code\r\n    // that falls out of the range of 2xx\r\n    message.error(error.response.data);\r\n    // console.log(error.response.status);\r\n    // console.log(error.response.headers);\r\n  } else if (error.request) {\r\n    // The request was made but no response was received\r\n    // `error.request` is an instance of XMLHttpRequest in the browser and an instance of\r\n    // http.ClientRequest in node.js\r\n    message.error(error.request);\r\n  } else {\r\n    // Something happened in setting up the request that triggered an Error\r\n    message.error('错误:', error.message);\r\n  }\r\n  // console.log(error.config);\r\n}","import React, { useState, useEffect } from 'react';\r\nimport { Form, Input, PageHeader, Button, Row, Col, Divider, Table, Popconfirm, message } from 'antd';\r\nimport CategoryComponent from './CategoryComponent'\r\nimport http from '@/utils/http'\r\nconst FormItem = Form.Item;\r\n\r\nconst Category = props => {\r\n  const [showDialog, setCategoryDialog] = useState(false);\r\n  const [editItem, setEditItem] = useState(null);\r\n  const [listData, setListData] = useState([]);\r\n  const [loading, setLoad] = useState(false);\r\n  const [Mounted, setMounted] = useState(false);\r\n  const [auth, setAuth] = useState();\r\n  let total = 0;\r\n  useEffect(() => {\r\n    getCategory();\r\n    setMounted(true);\r\n  }, [])\r\n  async function getCategory() {\r\n    setLoad(true);\r\n    await http.get('/admin/category/get').then(({ data }) => {\r\n      if (data.code == 0) {\r\n        setListData(data.data);\r\n        setAuth(data.auth)\r\n        total = data.data.length;\r\n        setLoad(false);\r\n      }\r\n    }).catch(error => {\r\n      console.log(error);\r\n      setLoad(false);\r\n    })\r\n  }\r\n\r\n  /*  搜索主干  */\r\n  const Search = () => {\r\n    const add = async () => {\r\n      await setEditItem(null)\r\n      setCategoryDialog(true)\r\n    }\r\n    return (\r\n      <Form layout=\"inline\" style={{ marginBottom: '20px' }}>\r\n        <Row gutter={{ md: 8, lg: 24, xl: 48 }} >\r\n          <Col md={24} sm={24}>\r\n            <FormItem>\r\n              <Input\r\n                style={{\r\n                  textAlign: 'center',\r\n                  marginBottom: 20\r\n                }}\r\n                placeholder=\"分类名\"\r\n              />\r\n            </FormItem>\r\n            <Button\r\n              style={{ marginTop: '3px', marginRight: 15 }}\r\n              type=\"primary\"\r\n              icon=\"search\">\r\n              搜索\r\n            </Button>\r\n            {\r\n              auth ? <Button\r\n                style={{ marginTop: '3px' }}\r\n                type=\"primary\"\r\n                onClick={add}>\r\n                新增\r\n            </Button>: ''\r\n            }\r\n          </Col>\r\n        </Row>\r\n      </Form>\r\n    )\r\n  }\r\n\r\n  /*  表单主干  */\r\n  const CategoryTable = ({ getCategory }) => {\r\n    const defaultSetting = {\r\n      total,\r\n      defaultCurrent: 1,\r\n      // pageSize:10,\r\n      showSizeChanger: true\r\n    }\r\n    const edit = async (item) => {\r\n      await setEditItem(item)\r\n      setCategoryDialog(true)\r\n    }\r\n    const del = async (item) => {\r\n      await http({\r\n        method: 'get',\r\n        params: {\r\n          id: item.id\r\n        },\r\n        url: '/admin/category/del'\r\n      }).then(({ data }) => {\r\n        if (data.code == 0) {\r\n          message.success(data.message);\r\n          getCategory()\r\n        } else {\r\n          message.error(data.message);\r\n        }\r\n      })\r\n    }\r\n    /**\r\n     * 列表表头\r\n     */\r\n    const columns = [\r\n      {\r\n        title: '分类名',\r\n        dataIndex: 'name',\r\n        key: 'name'\r\n      },\r\n      {\r\n        title: '描述',\r\n        dataIndex: 'desc',\r\n        key: 'desc'\r\n      },\r\n      {\r\n        title: '创建时间',\r\n        dataIndex: 'create_time',\r\n        key: 'create_time',\r\n        sorter: true\r\n      },\r\n      {\r\n        title: '操作',\r\n        dataIndex: 'operation',\r\n        key: 'operation',\r\n        render: (text, record) => (\r\n          auth ? <span>\r\n            <a onClick={() => { edit(record); }}>编辑</a><Divider type=\"vertical\" />\r\n            <Popconfirm title=\"确定要删除吗？\"\r\n              okText=\"确定\"\r\n              onConfirm={() => { del(record) }}\r\n              cancelText=\"取消\">\r\n              <a href=\"#\">删除</a>\r\n            </Popconfirm>\r\n          </span> : <span>您暂无操作权限</span>\r\n        )\r\n      }\r\n    ];\r\n    const handleChange = (page, pageSize) => {\r\n      //     setPageSize\r\n      //     current: 2\r\n      // defaultCurrent: 1\r\n      // pageSize: 10\r\n      // showSizeChanger: true\r\n      // total: 200\r\n    }\r\n    return (\r\n      <Table columns={columns}\r\n        dataSource={listData}\r\n        bordered\r\n        rowKey={(data) => (data.id)}\r\n        loading={loading}\r\n        pagination={defaultSetting}\r\n        onChange={handleChange} />\r\n    )\r\n  }\r\n\r\n  /*  分类主干  */\r\n  return (\r\n    <div>\r\n      <PageHeader title=\"分类管理\" />\r\n      <Search />\r\n      {Mounted && <><CategoryComponent\r\n        visibility={showDialog}\r\n        changeVisibility={setCategoryDialog}\r\n        getCategory={getCategory}\r\n        editItem={editItem} />\r\n        <CategoryTable changeVisibility={setCategoryDialog}\r\n          getCategory={getCategory}\r\n          setEditItem={setEditItem} /></>}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default React.memo(Category);\r\n\r\n"],"sourceRoot":""}